<!DOCTYPE html>
{% load static from staticfiles %}
{% load i18n %}
{% get_current_language as LANGUAGE_CODE %}
<html lang="{{ LANGUAGE_CODE|default:"es-ve" }}">
    {% include 'base.head.template.html' %}
    <body class="hold-transition skin-blue sidebar-mini">
        <div class="wrapper">

            <header class="main-header">
            <!-- Logo -->
                <a href="{% url 'inicio' %}" class="logo">
                    <!-- mini logo for sidebar mini 50x50 pixels -->
                    <span class="logo-mini"><b>S</b></span>
                    <!-- logo for regular state and mobile devices -->
                    <span class="logo-lg"><b>SIGETP</b></span>
                </a>
                <!-- Header Navbar: style can be found in header.less -->
                <nav class="navbar navbar-static-top">
                    <!-- Sidebar toggle button-->
                    <a href="#" class="sidebar-toggle" data-toggle="push-menu" role="button">
                        <span class="sr-only">Toggle navigation</span>
                    </a>

                    {% if request.user.is_authenticated %}
                    <div class="navbar-custom-menu">
                        <ul class="nav navbar-nav">
                            <!-- User Account: style can be found in dropdown.less -->
                            <li class="dropdown user user-menu">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                                    <i class="glyphicon glyphicon-user"></i>&#160;<span class="hidden-xs">{{ request.user.username }}</span>
                                </a>
                                <ul class="dropdown-menu">
                                    <!-- User image -->
                                    <li class="user-header">
                                        <p>{{ request.user.first_name }} {{ request.user.last_name }} <small>{{ request.user.date_joined|date }}</small></p>
                                    </li>
                                    <!-- Menu Body -->
                                    <li class="user-body">
                                        <div class="row">
                                            <div class="col-xs-12 text-center">
                                                <a href="{% url 'password_change' %}" class="btn btn-default btn-flat">Cambiar Contraseña</a>
                                            </div>
                                            <!--<div class="col-xs-4 text-center">
                                                <a href="#">Opción 2</a>
                                            </div>
                                            <div class="col-xs-4 text-center">
                                                <a href="#">Opción 3</a>
                                            </div>-->
                                        </div>
                                        <!-- /.row -->
                                    </li>
                                    <!-- Menu Footer-->
                                    <li class="user-footer">
                                        <div class="pull-left">
                                            <a href="#" class="btn btn-default btn-flat">Perfil</a>
                                        </div>
                                        <div class="pull-right">
                                            <a href="{% url 'logout' %}" class="btn btn-default btn-flat">
                                                <i class="glyphicon glyphicon-log-out"></i>&#160;Salir
                                            </a>
                                        </div>
                                    </li>
                                </ul>
                            </li>
                            <!-- Control Sidebar Toggle Button -->
                        </ul>
                    </div>
                    {% else %}
                    <div class="navbar-custom-menu">
                        <ul class="nav navbar-nav">
                            <!-- User Account: style can be found in dropdown.less -->
                            <li class="dropdown user user-menu">
                                <a href="{% url 'login' %}">
                                    <i class="glyphicon glyphicon-log-in"></i>&#160;<span class="hidden-xs">Iniciar Seción</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                    {% endif %}
                </nav>
            </header>

            {% if request.user.is_authenticated %}
            <!-- Left side column. contains the logo and sidebar -->
            <aside class="main-sidebar">
                <!-- sidebar: style can be found in sidebar.less -->
                <section class="sidebar">
                    <!-- sidebar menu: : style can be found in sidebar.less -->
                    <ul class="sidebar-menu" data-widget="tree">
                        <li class="header">MENÚ PRINCIPAL</li>
                        <li id="in"><a href="{% url 'inicio' %}"><i class="fa fa-dashboard"></i> <span>Inicio</span></a></li>
                        <li class="treeview" id="vi">
                            <a href="#">
                                <i class="fa fa-hand-o-right"></i> <span>Viviendas</span>
                                <span class="pull-right-container">
                                    <i class="fa fa-angle-left pull-right" id="angle"></i>
                                </span>
                            </a>
                            <ul class="treeview-menu">
                                <li id="viv"><a href="{%  url 'vivienda_lista' %}"><i class="fa fa-home"></i> <span>Vivienda</span></a></li>
                                <li id="im"><a href="{%  url 'imagen_lista' %}"><i class="fa fa-camera"></i> <span>Imágenes</span></a></li>
                            </ul>
                        </li>
                        <li id="gf"><a href="{% url 'grupo_familiar_lista' %}"><i class="fa fa-users"></i> <span>Grupo Familiar</span></a></li>
                        <li id="pe"><a href="{% url 'persona_lista' %}"><i class="fa fa-user-plus"></i> <span>Persona</span></a></li>
                    </ul>
                </section>
                <!-- /.sidebar -->
            </aside>
            {% endif %}
            
            <!-- Content Wrapper. Contains page content -->
            <div class="content-wrapper">
                <!-- Content Header (Page header) -->
                <section class="content-header">
                    <h1>{% block content_header_title %}{% trans 'Página Principal' %}{% endblock %}</h1>
                    <ol class="breadcrumb">
                        <li><a href="{% url 'inicio' %}"><i class="fa fa-dashboard"></i> Inicio</a></li>
                        {% block content_header_roadmap %}
                        {% endblock %}
                    </ol>
                </section>
                <!-- Main content -->
                <section class="content">
                    {% block contenido %}
                        <div class="box box-info">
                            <div class="box-header text-center">
                                <h3 class="box-title">Título</h3>
                            </div>
                            <div class="box-body text-center">
                                {% if not request.user.is_authenticated %}
                                    <p>Bienvenido, inicia en la aplicación para empezar a usarla</p>
                                    <p><a class="btn btn-info" href="{% url 'login' %}">Entrar al Sistema</a></p>
                                {% else %}
                                    <p>Bienvenido {{ request.user.username }}, se te ha desplegado un menú. Úsalo para comenzar a registrar los datos</p>
                                {% endif %}
                            </div>
                        </div>
                    {% endblock %}
                </section>
                <!-- /.content -->
            </div>
            <!-- /.content-wrapper -->

            {% include 'base.footer.info.template.html' %}
        </div>
        <!-- ./wrapper -->

        {% include 'base.footer.template.html' %}
        <script type="text/javascript">
            $(document).ready(function()
            {
                //controla el comportamiento del menu para saber cual esta activo e inactivo para el usuario

                //obtiene la url actual del sistema
                var ruta = "{{ request.path }}";

                //rutas de la app vivienda
                var vi_1 = "/vivienda/";
                var vi_2 = "/vivienda/registro/";
                var vi_3 = "/vivienda/editar/";
                var vi_4 = "/vivienda/eliminar/";
                var im_1 = "/vivienda/imagen/";
                var im_2 = "/vivienda/imagen/registro/"

                //rutas de la app grupo_familiar
                var gf_1 = "/vivienda/grupo-familiar/";
                var gf_2 = "/vivienda/grupo-familiar/registro/";
                var gf_3 = "/vivienda/grupo-familiar/editar/";
                var gf_4 = "/vivienda/grupo-familiar/eliminar/";

                //rutas de la app persona
                var pe_1 = "/vivienda/grupo-familiar/persona/";
                var pe_2 = "/vivienda/grupo-familiar/persona/registro/";
                var pe_3 = "/vivienda/grupo-familiar/persona/editar/";
                var pe_4 = "/vivienda/grupo-familiar/persona/eliminar/";

                if( ruta == "/" )
                {
                    $("#in").addClass("active");
                }
                else if( ruta == vi_1 || ruta == vi_2 || ruta == vi_3 || ruta == vi_4 )
                {
                    $("#vi").addClass("active");
                    $("#viv").addClass("active");
                    $("#angle").removeClass("fa-angle-left")
                    $("#angle").addClass("fa-angle-down")
                }
                else if( ruta == im_1 || ruta == im_2 )
                {
                    $("#vi").addClass("active");
                    $("#im").addClass("active");
                    $("#angle").removeClass("fa-angle-left")
                    $("#angle").addClass("fa-angle-down")
                }
                else if( ruta == gf_1 || ruta == gf_2 || ruta == gf_3 || ruta == gf_4 )
                {
                    $("#gf").addClass("active");
                }
                else if( ruta == pe_1 || ruta == pe_2 || ruta == pe_3 || ruta == pe_4 )
                {
                    $("#pe").addClass("active");
                }
            });
        </script>
        {% block extra_footer %}{% endblock %}
    </body>
</html>
